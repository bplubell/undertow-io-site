<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <title>SimpleNonceManager (Undertow 1.4.13.Final-SNAPSHOT API)</title> <meta name="date" content="2017-04-06"> <link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style"> <script type="text/javascript" src="../../../../script.js"></script> </head> <body> <script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SimpleNonceManager (Undertow 1.4.13.Final-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script> <noscript> <div>JavaScript is disabled on your browser.</div> </noscript> <div class="topNav"><a name="navbar.top"> </a> <div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div> <a name="navbar.top.firstrow"> </a> <ul class="navList" title="Navigation"> <li><a href="../../../../overview-summary.html">Overview</a></li> <li><a href="package-summary.html">Package</a></li> <li class="navBarCell1Rev">Class</li> <li><a href="class-use/SimpleNonceManager.html">Use</a></li> <li><a href="package-tree.html">Tree</a></li> <li><a href="../../../../deprecated-list.html">Deprecated</a></li> <li><a href="../../../../index-all.html">Index</a></li> <li><a href="../../../../help-doc.html">Help</a></li> </ul> <div class="aboutLanguage"><b>Undertow 1.4.13.Final-SNAPSHOT</b></div> </div> <div class="subNav"> <ul class="navList"> <li><a href="../../../../io/undertow/security/impl/SecurityContextImpl.html" title="class in io.undertow.security.impl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li> <li><a href="../../../../io/undertow/security/impl/SingleSignOn.html" title="interface in io.undertow.security.impl"><span class="typeNameLink">Next&nbsp;Class</span></a></li> </ul> <ul class="navList"> <li><a href="../../../../index.html?io/undertow/security/impl/SimpleNonceManager.html" target="_top">Frames</a></li> <li><a href="SimpleNonceManager.html" target="_top">No&nbsp;Frames</a></li> </ul> <ul class="navList" id="allclasses_navbar_top"> <li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li> </ul> <div> <script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script> </div> <div> <ul class="subNavList"> <li>Summary:&nbsp;</li> <li>Nested&nbsp;|&nbsp;</li> <li>Field&nbsp;|&nbsp;</li> <li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li> <li><a href="#method.summary">Method</a></li> </ul> <ul class="subNavList"> <li>Detail:&nbsp;</li> <li>Field&nbsp;|&nbsp;</li> <li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li> <li><a href="#method.detail">Method</a></li> </ul> </div> <a name="skip.navbar.top"> </a></div> <div class="header"> <div class="subTitle">io.undertow.security.impl</div> <h2 title="Class SimpleNonceManager" class="title">Class SimpleNonceManager</h2> </div> <div class="contentContainer"> <ul class="inheritance"> <li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li> <li> <ul class="inheritance"> <li>io.undertow.security.impl.SimpleNonceManager</li> </ul> </li> </ul> <div class="description"> <ul class="blockList"> <li class="blockList"> <dl> <dt>All Implemented Interfaces:</dt> <dd><a href="../../../../io/undertow/security/api/NonceManager.html" title="interface in io.undertow.security.api">NonceManager</a>, <a href="../../../../io/undertow/security/api/SessionNonceManager.html" title="interface in io.undertow.security.api">SessionNonceManager</a></dd> </dl> <hr> <br> <pre>public class <span class="typeNameLabel">SimpleNonceManager</span>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../io/undertow/security/api/SessionNonceManager.html" title="interface in io.undertow.security.api">SessionNonceManager</a></pre> <div class="block">A default <a href="../../../../io/undertow/security/api/NonceManager.html" title="interface in io.undertow.security.api"><code>NonceManager</code></a> implementation to provide reasonable single host management of nonces. This <a href="../../../../io/undertow/security/api/NonceManager.html" title="interface in io.undertow.security.api"><code>NonceManager</code></a> manages nonces in two groups, the first is the group that are allocated to new requests, this group is a problem as we want to be able to limit how many we distribute so we don't have a DOS storing too many but we also don't a high number of requests to to push the other valid nonces out faster than they can be used. The second group is the set of nonces actively in use - these should be maintained as we can also maintain the nonce count and even track the next nonce once invalid. Maybe group one should be a timestamp and private key hashed together, if used with a nonce count they move to be tracked to ensure the same count is not used again - if successfully used without a nonce count add to a blacklist until expiration? A nonce used without a nonce count will essentially be single use with each request getting a new nonce.</div> <dl> <dt><span class="simpleTagLabel">Author:</span></dt> <dd><a href="mailto:darran.lofthouse@jboss.com">Darran Lofthouse</a></dd> </dl> </li> </ul> </div> <div class="summary"> <ul class="blockList"> <li class="blockList"> <ul class="blockList"> <li class="blockList"><a name="constructor.summary"> </a> <h3>Constructor Summary</h3> <table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation"> <caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption> <tr> <th class="colOne" scope="col">Constructor and Description</th> </tr> <tr class="altColor"> <td class="colOne"><code><span class="memberNameLink"><a href="../../../../io/undertow/security/impl/SimpleNonceManager.html#SimpleNonceManager--">SimpleNonceManager</a></span>()</code>&nbsp;</td> </tr> <tr class="rowColor"> <td class="colOne"><code><span class="memberNameLink"><a href="../../../../io/undertow/security/impl/SimpleNonceManager.html#SimpleNonceManager-java.lang.String-">SimpleNonceManager</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;hashAlg)</code>&nbsp;</td> </tr> </table> </li> </ul> <ul class="blockList"> <li class="blockList"><a name="method.summary"> </a> <h3>Method Summary</h3> <table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation"> <caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption> <tr> <th class="colFirst" scope="col">Modifier and Type</th> <th class="colLast" scope="col">Method and Description</th> </tr> <tr id="i0" class="altColor"> <td class="colFirst"><code>void</code></td> <td class="colLast"><code><span class="memberNameLink"><a href="../../../../io/undertow/security/impl/SimpleNonceManager.html#associateHash-java.lang.String-byte:A-">associateHash</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;nonce, byte[]&nbsp;hash)</code> <div class="block">Associate the supplied hash with the nonce specified.</div> </td> </tr> <tr id="i1" class="rowColor"> <td class="colFirst"><code>byte[]</code></td> <td class="colLast"><code><span class="memberNameLink"><a href="../../../../io/undertow/security/impl/SimpleNonceManager.html#lookupHash-java.lang.String-">lookupHash</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;nonce)</code> <div class="block">Retrieve the existing hash associated with the nonce specified.</div> </td> </tr> <tr id="i2" class="altColor"> <td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td> <td class="colLast"><code><span class="memberNameLink"><a href="../../../../io/undertow/security/impl/SimpleNonceManager.html#nextNonce-java.lang.String-io.undertow.server.HttpServerExchange-">nextNonce</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;lastNonce, <a href="../../../../io/undertow/server/HttpServerExchange.html" title="class in io.undertow.server">HttpServerExchange</a>&nbsp;exchange)</code> <div class="block">Select the next nonce to be sent from the server taking into account the last valid nonce.</div> </td> </tr> <tr id="i3" class="rowColor"> <td class="colFirst"><code>boolean</code></td> <td class="colLast"><code><span class="memberNameLink"><a href="../../../../io/undertow/security/impl/SimpleNonceManager.html#validateNonce-java.lang.String-int-io.undertow.server.HttpServerExchange-">validateNonce</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;nonce, int&nbsp;nonceCount, <a href="../../../../io/undertow/server/HttpServerExchange.html" title="class in io.undertow.server">HttpServerExchange</a>&nbsp;exchange)</code> <div class="block">Validate that a nonce can be used.</div> </td> </tr> </table> <ul class="blockList"> <li class="blockList"><a name="methods.inherited.from.class.java.lang.Object"> </a> <h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3> <code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li> </ul> </li> </ul> </li> </ul> </div> <div class="details"> <ul class="blockList"> <li class="blockList"> <ul class="blockList"> <li class="blockList"><a name="constructor.detail"> </a> <h3>Constructor Detail</h3> <a name="SimpleNonceManager--"> </a> <ul class="blockList"> <li class="blockList"> <h4>SimpleNonceManager</h4> <pre>public&nbsp;SimpleNonceManager()</pre> </li> </ul> <a name="SimpleNonceManager-java.lang.String-"> </a> <ul class="blockListLast"> <li class="blockList"> <h4>SimpleNonceManager</h4> <pre>public&nbsp;SimpleNonceManager(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;hashAlg)</pre> </li> </ul> </li> </ul> <ul class="blockList"> <li class="blockList"><a name="method.detail"> </a> <h3>Method Detail</h3> <a name="nextNonce-java.lang.String-io.undertow.server.HttpServerExchange-"> </a> <ul class="blockList"> <li class="blockList"> <h4>nextNonce</h4> <pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;nextNonce(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;lastNonce,
                        <a href="../../../../io/undertow/server/HttpServerExchange.html" title="class in io.undertow.server">HttpServerExchange</a>&nbsp;exchange)</pre> <div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../io/undertow/security/api/NonceManager.html#nextNonce-java.lang.String-io.undertow.server.HttpServerExchange-">NonceManager</a></code></span></div> <div class="block">Select the next nonce to be sent from the server taking into account the last valid nonce. It is both possible and likely that the nonce last used by the client will still be valid, in that case the same nonce will be returned.</div> <dl> <dt><span class="overrideSpecifyLabel">Specified by:</span></dt> <dd><code><a href="../../../../io/undertow/security/api/NonceManager.html#nextNonce-java.lang.String-io.undertow.server.HttpServerExchange-">nextNonce</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../io/undertow/security/api/NonceManager.html" title="interface in io.undertow.security.api">NonceManager</a></code></dd> <dt><span class="paramLabel">Parameters:</span></dt> <dd><code>lastNonce</code> - - The last valid nonce received from the client or null if we don't already have a nonce.</dd> <dt><span class="returnLabel">Returns:</span></dt> <dd>The next nonce to be sent in a challenge to the client.</dd> <dt><span class="seeLabel">See Also:</span></dt> <dd><a href="../../../../io/undertow/security/api/NonceManager.html#nextNonce-java.lang.String-io.undertow.server.HttpServerExchange-"><code>NonceManager.nextNonce(java.lang.String, io.undertow.server.HttpServerExchange)</code></a></dd> </dl> </li> </ul> <a name="validateNonce-java.lang.String-int-io.undertow.server.HttpServerExchange-"> </a> <ul class="blockList"> <li class="blockList"> <h4>validateNonce</h4> <pre>public&nbsp;boolean&nbsp;validateNonce(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;nonce,
                             int&nbsp;nonceCount,
                             <a href="../../../../io/undertow/server/HttpServerExchange.html" title="class in io.undertow.server">HttpServerExchange</a>&nbsp;exchange)</pre> <div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../io/undertow/security/api/NonceManager.html#validateNonce-java.lang.String-int-io.undertow.server.HttpServerExchange-">NonceManager</a></code></span></div> <div class="block">Validate that a nonce can be used. If the nonce can not be used but the related digest was correct then a new nonce should be returned to the client indicating that the nonce was stale. For implementations of this interface this method is not expected by be idempotent, i.e. once a nonce is validated with a specific nonceCount it is not expected that this method will return true again if the same combination is presented. This method is expected to ONLY be called if the users credentials are valid as a storage overhead could be incurred this overhead must not be accessible to unauthenticated clients.</div> <dl> <dt><span class="overrideSpecifyLabel">Specified by:</span></dt> <dd><code><a href="../../../../io/undertow/security/api/NonceManager.html#validateNonce-java.lang.String-int-io.undertow.server.HttpServerExchange-">validateNonce</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../io/undertow/security/api/NonceManager.html" title="interface in io.undertow.security.api">NonceManager</a></code></dd> <dt><span class="paramLabel">Parameters:</span></dt> <dd><code>nonce</code> - - The nonce received from the client.</dd> <dd><code>nonceCount</code> - - The nonce count from the client or -1 of none specified.</dd> <dt><span class="returnLabel">Returns:</span></dt> <dd>true if the nonce can be used otherwise return false.</dd> <dt><span class="seeLabel">See Also:</span></dt> <dd><a href="../../../../io/undertow/security/api/NonceManager.html#validateNonce-java.lang.String-int-io.undertow.server.HttpServerExchange-"><code>NonceManager.validateNonce(java.lang.String, int, io.undertow.server.HttpServerExchange)</code></a></dd> </dl> </li> </ul> <a name="associateHash-java.lang.String-byte:A-"> </a> <ul class="blockList"> <li class="blockList"> <h4>associateHash</h4> <pre>public&nbsp;void&nbsp;associateHash(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;nonce,
                          byte[]&nbsp;hash)</pre> <div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../io/undertow/security/api/SessionNonceManager.html#associateHash-java.lang.String-byte:A-">SessionNonceManager</a></code></span></div> <div class="block">Associate the supplied hash with the nonce specified.</div> <dl> <dt><span class="overrideSpecifyLabel">Specified by:</span></dt> <dd><code><a href="../../../../io/undertow/security/api/SessionNonceManager.html#associateHash-java.lang.String-byte:A-">associateHash</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../io/undertow/security/api/SessionNonceManager.html" title="interface in io.undertow.security.api">SessionNonceManager</a></code></dd> <dt><span class="paramLabel">Parameters:</span></dt> <dd><code>nonce</code> - - The nonce the hash is to be associated with.</dd> <dd><code>hash</code> - - The hash to associate.</dd> </dl> </li> </ul> <a name="lookupHash-java.lang.String-"> </a> <ul class="blockListLast"> <li class="blockList"> <h4>lookupHash</h4> <pre>public&nbsp;byte[]&nbsp;lookupHash(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;nonce)</pre> <div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../io/undertow/security/api/SessionNonceManager.html#lookupHash-java.lang.String-">SessionNonceManager</a></code></span></div> <div class="block">Retrieve the existing hash associated with the nonce specified. If there is no association then null should be returned.</div> <dl> <dt><span class="overrideSpecifyLabel">Specified by:</span></dt> <dd><code><a href="../../../../io/undertow/security/api/SessionNonceManager.html#lookupHash-java.lang.String-">lookupHash</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../io/undertow/security/api/SessionNonceManager.html" title="interface in io.undertow.security.api">SessionNonceManager</a></code></dd> <dt><span class="paramLabel">Parameters:</span></dt> <dd><code>nonce</code> - - The nonce the hash is required for.</dd> <dt><span class="returnLabel">Returns:</span></dt> <dd>The associated hash or null if there is no association.</dd> </dl> </li> </ul> </li> </ul> </li> </ul> </div> </div> <div class="bottomNav"><a name="navbar.bottom"> </a> <div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div> <a name="navbar.bottom.firstrow"> </a> <ul class="navList" title="Navigation"> <li><a href="../../../../overview-summary.html">Overview</a></li> <li><a href="package-summary.html">Package</a></li> <li class="navBarCell1Rev">Class</li> <li><a href="class-use/SimpleNonceManager.html">Use</a></li> <li><a href="package-tree.html">Tree</a></li> <li><a href="../../../../deprecated-list.html">Deprecated</a></li> <li><a href="../../../../index-all.html">Index</a></li> <li><a href="../../../../help-doc.html">Help</a></li> </ul> <div class="aboutLanguage"><b>Undertow 1.4.13.Final-SNAPSHOT</b></div> </div> <div class="subNav"> <ul class="navList"> <li><a href="../../../../io/undertow/security/impl/SecurityContextImpl.html" title="class in io.undertow.security.impl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li> <li><a href="../../../../io/undertow/security/impl/SingleSignOn.html" title="interface in io.undertow.security.impl"><span class="typeNameLink">Next&nbsp;Class</span></a></li> </ul> <ul class="navList"> <li><a href="../../../../index.html?io/undertow/security/impl/SimpleNonceManager.html" target="_top">Frames</a></li> <li><a href="SimpleNonceManager.html" target="_top">No&nbsp;Frames</a></li> </ul> <ul class="navList" id="allclasses_navbar_bottom"> <li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li> </ul> <div> <script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script> </div> <div> <ul class="subNavList"> <li>Summary:&nbsp;</li> <li>Nested&nbsp;|&nbsp;</li> <li>Field&nbsp;|&nbsp;</li> <li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li> <li><a href="#method.summary">Method</a></li> </ul> <ul class="subNavList"> <li>Detail:&nbsp;</li> <li>Field&nbsp;|&nbsp;</li> <li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li> <li><a href="#method.detail">Method</a></li> </ul> </div> <a name="skip.navbar.bottom"> </a></div> <p class="legalCopy"><small>Copyright &#169; 2017 <a href="http://www.jboss.org">JBoss by Red Hat</a>. All rights reserved.</small></p> </body> </html>